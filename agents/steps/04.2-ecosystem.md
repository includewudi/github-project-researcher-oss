# Step 4.2: Ecosystem Audit — Currency & Modern Replacements

> **返回索引:** [SKILL_FULL.md](../../SKILL_FULL.md)

**When to Use:** When the project makes recommendations, endorses tools, or prescribes workflows — especially if the project is older than 2 years.

This step was evolved from researching `realpython/python-guide` where 5 parallel librarian agents were needed to audit 2018-era recommendations against 2026 reality.

---

## 4.2.0 Ecosystem Audit Gate (MANDATORY)

Before running the full audit, count claim-bearing statements:

```bash
CLAIM_COUNT=$(rg -c "recommend|best practice|should|avoid|prefer|use.*instead|don't use|we suggest" --include="*.rst" --include="*.md" . 2>/dev/null | awk -F: '{s+=$2} END {print s+0}')
echo "Claims found: $CLAIM_COUNT"
```

| Claims Found | Action |
|-------------|--------|
| < 5 | **SKIP** Step 4.2 entirely — insufficient claims to audit |
| 5-15 | Run lightweight audit (Steps 4.2.1-4.2.3, 2-3 librarian agents) |
| > 15 | Run full audit (Steps 4.2.1-4.2.4, 3-6 librarian agents) |

> **Why:** Firing 5+ parallel agents for a project with 2 opinionated sentences wastes resources. Gate first.

---

## 4.2.1 Extract Claims/Recommendations Inventory

```bash
# Find opinionated statements
rg "recommend|best practice|should|avoid|prefer|use.*instead|don't use|we suggest" --include="*.rst" --include="*.md" --include="*.py" -n . | head -40

# For docs projects: find tool/library endorsements
rg "\`\`[a-z]" --include="*.rst" -o | sort | uniq -c | sort -rn | head -20
```

**Create audit priority table (10-30 items):**

| # | Claim/Recommendation | Source File | Priority |
|---|---------------------|-------------|----------|
| 1 | "Use Pipenv for dependency management" | installing/linux.rst | **High** — core workflow |
| 2 | "pytest is the best test runner" | testing.rst | **Low** — still true |

**Priority Rules:**
- **High**: Core workflow tools, language features, security practices
- **Medium**: Library recommendations, deployment approaches
- **Low**: Style preferences, minor tooling

---

## 4.2.2 Run Parallel "Modern State" Checks

Fire 3-6 `librarian` agents in parallel (background), each covering a cluster of claims:

```
# Example: Python ecosystem audit
librarian(prompt="Current state of Python packaging 2026: pip vs uv vs poetry vs pdm.")
librarian(prompt="Current state of Python linting/formatting 2026: flake8 vs ruff, black vs ruff format.")
librarian(prompt="Current state of Python testing 2026: pytest ecosystem, coverage tools.")
```

Also fire 1-2 web searches for ecosystem-wide signals:

```
websearch("Python developer survey 2025 2026 tooling adoption")
websearch("{domain} best practices {current_year} state of the art")
```

---

## 4.2.3 Build "Modern Replacements" Decision Table

Synthesize librarian + web search results:

| Area | Guide Recommendation | 2026 Reality | Why Changed | Migration Path |
|------|---------------------|--------------|-------------|----------------|
| Package Manager | pip + virtualenv | **uv** | 10-100× faster | `pip install uv` → `uv init` |
| Linter | flake8 + isort | **ruff** | Single tool, 100× faster | `pip install ruff` |

---

## 4.2.4 Write Appendix in RESEARCH.md

Add at the end of RESEARCH.md:

```markdown
## Appendix: Modern Replacements ({year})

### TL;DR Verdict

{One paragraph: still valid / needs update / actively misleading}

### Migration Table

| Area | Guide Says | Current Best | Status | Evidence |
|------|-----------|--------------|--------|----------|
| ... | ... | ... | ✅ Still Valid / ⚠️ Outdated / ❌ Replaced | {adoption signal} |

### Key Shifts

{2-3 paragraphs on the most impactful changes}

### Data Sources

- {List URLs and surveys consulted}
```

**Stop Condition:** All **High** priority claims have a verdict with at least one supporting adoption signal.
